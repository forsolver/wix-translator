/**
 * @file: Project.md
 * @description: Детальное описание проекта, архитектуры, этапов, стандартов
 * @dependencies: task_description.md, export_en.csv
 * @created: 2025-05-26
 * @updated: 2025-05-26 - обновлено согласно новым требованиям
 */

# Project: Автоматизация перевода экспортированных данных Wix

## Цели проекта
- Автоматизировать перевод текстов из экспортированного CSV Wix с помощью GPT-4o
- Поддерживать фильтрацию по типам строк (только переводимые элементы интерфейса)
- Специальная обработка меню (только теги `<label>`)
- Сохранить структуру HTML и CSV
- Обеспечить максимальную производительность для больших файлов (до 50,000 строк)
- Реализовать кэширование для повторяющихся переводов

## Архитектура
- **Язык реализации**: Python 3.10+
- **Основные компоненты**:
  - Модуль фильтрации типов строк
  - Модуль парсинга и обработки CSV
  - Модуль извлечения и замены текста в HTML-тегах
  - Асинхронный модуль интеграции с OpenAI GPT-4o
  - Система кэширования переводов
  - Модуль логирования (только ошибки и критические события)
  - CLI-интерфейс

## Поддерживаемые типы строк
- **Переводимые типы**:
  - `catalog-product` - элементы каталога продуктов
  - `wysiwyg.viewer.components.WRichText` - богатый текстовый контент
  - `document.api.MenuService.Menu` - меню (только содержимое тегов `<label>`)
- **Исключаемые типы**:
  - `offline_payment_method` - методы оффлайн оплаты

## Поддерживаемые HTML теги
- **Основные теги**: `<b>`, `<h1>`, `<h2>`, `<li>`, `<ol>`, `<p>`, `<ul>`
- **Специальные теги для меню**: `<label>` (только для типа `document.api.MenuService.Menu`)

## Оптимизации производительности
- **Асинхронная обработка**: `openai.AsyncClient` для максимальной скорости
- **Batching**: перевод всех текстов одного типа тегов одним запросом
- **Кэширование**: сохранение переводов в `.translation_cache.json` с MD5-ключами
- **Фильтрация**: удаление пустых и дублирующихся текстов
- **Умная фильтрация строк**: обработка только переводимых типов
- **Логирование**: только ошибки для минимизации накладных расходов

## Этапы разработки
1. ✅ Проектирование архитектуры и документации
2. ✅ Реализация парсинга и обработки CSV
3. ✅ Интеграция с OpenAI API (GPT-4o) с batching
4. ✅ Фильтрация и обработка дублей
5. ✅ Фильтрация типов строк
6. ✅ Специальная обработка меню
7. ✅ Асинхронная обработка
8. ✅ Кэширование переводов
9. ✅ Примеры запуска и тестовые файлы
10. ✅ Документирование

## Файловая структура
```
/
├── parser.py                    # Основной модуль
├── requirements.txt             # Зависимости Python
├── .env                        # Конфигурация (OpenAI API ключ)
├── .translation_cache.json     # Кэш переводов (автосоздается)
├── examples/
│   ├── run_examples.md         # Примеры запуска
│   └── test_data.csv          # Тестовые данные
└── docs/
    ├── Project.md             # Этот файл
    ├── Tasktracker.md         # Трекер задач
    ├── changelog.md           # История изменений
    └── Diary.md               # Технические решения
```

## Используемые технологии
- **Python 3.10+**
- **OpenAI API (GPT-4o)** - асинхронный клиент
- **pandas** - обработка CSV
- **beautifulsoup4** - парсинг HTML
- **tqdm** - индикатор прогресса
- **python-dotenv** - загрузка конфигурации
- **asyncio** - асинхронность
- **hashlib, json** - кэширование

## Стандарты безопасности
- API ключи в `.env` файле (исключен из Git)
- Обработка ошибок API с fallback на оригинальные тексты
- Валидация входных данных
- Логирование только критических ошибок

## Консистентность
- Все изменения фиксируются в `changelog.md` и `tasktracker.md`
- Архитектурные изменения отражаются в этом файле
- Код следует стандартам PEP8, SOLID, KISS, DRY

---

*Документ актуализируется при изменениях архитектуры или требований.* 